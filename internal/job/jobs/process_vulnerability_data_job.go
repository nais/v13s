package jobs

import (
	"time"

	"github.com/nais/v13s/internal/sources"
	"github.com/riverqueue/river"
)

const KindProcessVulnerabilityData = "process_vulnerability_data"

type ProcessVulnerabilityDataJob struct {
	Batch *sources.ImageVulnerabilityData
}

func (ProcessVulnerabilityDataJob) Kind() string { return KindProcessVulnerabilityData }

func (j ProcessVulnerabilityDataJob) InsertOpts() river.InsertOpts {
	return river.InsertOpts{
		Queue: KindProcessVulnerabilityData,
		UniqueOpts: river.UniqueOpts{
			ByArgs:   true,
			ByPeriod: 2 * time.Minute,
		},
		MaxAttempts: 5,
	}
}
