package job

import (
	"github.com/nais/v13s/internal/sources"
	"github.com/riverqueue/river"
)

const KindProcessVulnerabilityDataBatch = "process_vulnerability_data_batch"

type ProcessVulnerabilityDataBatchJob struct {
	Batches []*sources.ImageVulnerabilityData
}

func (ProcessVulnerabilityDataBatchJob) Kind() string { return KindProcessVulnerabilityDataBatch }

func (j ProcessVulnerabilityDataBatchJob) InsertOpts() river.InsertOpts {
	return river.InsertOpts{
		Queue:       KindProcessVulnerabilityDataBatch,
		MaxAttempts: 5,
	}
}
